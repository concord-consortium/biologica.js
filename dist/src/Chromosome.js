// Generated by CoffeeScript 1.3.3
(function() {
  var __hasProp = {}.hasOwnProperty;

  BioLogica.Chromosome = (function() {

    function Chromosome(species, chromosome, side, alleles) {
      this.species = species;
      this.chromosome = chromosome;
      this.side = side;
      this.alleles = alleles;
    }

    Chromosome.prototype.clone = function(newSide) {
      return new BioLogica.Chromosome(this.species, this.chromosome, newSide || this.side, this.alleles.slice(0));
    };

    Chromosome.prototype.lengthInCentimorgans = 100;

    Chromosome.prototype.getlengthInBasePairs = function() {
      return this.species.chromosomesLength[this.chromosome];
    };

    Chromosome.prototype.getGeneOfAllele = function(allele) {
      var gene, geneName, _ref;
      _ref = this.species.geneList;
      for (geneName in _ref) {
        if (!__hasProp.call(_ref, geneName)) continue;
        gene = _ref[geneName];
        if (~gene.alleles.indexOf(allele)) {
          return geneName;
        }
      }
    };

    Chromosome.prototype.getAllelesPosition = function(allele) {
      var geneName;
      geneName = this.getGeneOfAllele(allele);
      return this.species.geneList[geneName].start;
    };

    return Chromosome;

  })();

  BioLogica.Chromosome.createChromosome = function(chr1, chr2, crossPoint) {
    var allele, i, newAlleles, _i, _len, _ref;
    newAlleles = [];
    _ref = chr1.alleles;
    for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {
      allele = _ref[i];
      if (chr1.getAllelesPosition(allele) < crossPoint) {
        newAlleles.push(allele);
      } else {
        newAlleles.push(chr2.alleles[i]);
      }
    }
    return new BioLogica.Chromosome(chr1.species, chr1.chromosome, chr1.side, newAlleles);
  };

}).call(this);
